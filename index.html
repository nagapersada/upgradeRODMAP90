<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>DVTEAM PRO - Roadmap</title>

    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#000000">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <link rel="apple-touch-icon" href="logo.png">
    <link rel="icon" type="image/png" href="logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --gold: #d4af37;
            --gold-glow: rgba(212, 175, 55, 0.3);
            --bg-dark: #050505;
            --card-glass: rgba(25, 25, 25, 0.9);
            --border-glass: rgba(255, 255, 255, 0.1);
            --text-main: #ffffff;
            --text-muted: #888888;
            --green: #00e676;
            --red: #ff5252;
            --font-main: 'Plus Jakarta Sans', sans-serif;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }
        
        body {
            font-family: var(--font-main);
            background-color: var(--bg-dark);
            background-image: radial-gradient(circle at top center, #1a1a1a 0%, #000000 70%);
            color: var(--text-main);
            margin: 0; padding: 0;
            height: 100vh;
            display: flex; flex-direction: column; overflow: hidden;
        }

        /* --- UTILS --- */
        .txt-gold { color: var(--gold); }
        .txt-green { color: var(--green); }
        .flex-between { display: flex; justify-content: space-between; align-items: center; }

        /* --- SPLASH SCREEN --- */
        #splash {
            position: fixed; inset: 0; z-index: 9999;
            background: #000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: opacity 0.5s ease;
        }
        .splash-logo { width: 120px; height: 120px; object-fit: contain; filter: drop-shadow(0 0 30px var(--gold-glow)); margin-bottom: 20px; }
        .splash-title { font-size: 1.5rem; font-weight: 800; letter-spacing: 4px; color: var(--gold); margin-bottom: 5px; }
        .splash-sub { font-size: 0.8rem; color: #666; letter-spacing: 2px; }

        /* --- APP CONTAINER --- */
        #app { display: none; flex-direction: column; height: 100%; opacity: 0; transition: opacity 0.6s; }

        /* --- HEADER --- */
        header {
            height: 65px; padding: 0 20px;
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(0,0,0,0.8); backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-glass);
            position: fixed; top: 0; width: 100%; z-index: 100;
        }
        .brand { font-weight: 800; font-size: 1.1rem; letter-spacing: 1px; display: flex; align-items: center; gap: 10px; }
        .brand img { height: 28px; width: auto; }
        
        .btn-icon {
            background: rgba(255,255,255,0.05); border: 1px solid var(--border-glass);
            color: var(--gold); width: 36px; height: 36px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; cursor: pointer;
            transition: all 0.2s;
        }
        .btn-icon:active { transform: scale(0.9); background: rgba(212,175,55,0.1); }
        .btn-icon svg { width: 18px; height: 18px; fill: currentColor; }

        /* --- CONTENT AREA --- */
        .scroll-content {
            flex: 1; overflow-y: auto; padding: 85px 20px 40px 20px;
            display: flex; flex-direction: column; gap: 20px;
            max-width: 800px; margin: 0 auto; width: 100%;
        }

        /* --- HERO CARD (SALDO) --- */
        .hero-card {
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a);
            border: 1px solid var(--gold);
            border-radius: 20px; padding: 25px;
            text-align: center;
            box-shadow: 0 10px 30px -10px rgba(212,175,55,0.15);
            position: relative; overflow: hidden;
        }
        .hero-card::before {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: radial-gradient(circle, rgba(212,175,55,0.1) 0%, transparent 60%);
            animation: rotateBg 10s linear infinite; pointer-events: none;
        }
        @keyframes rotateBg { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        
        .hero-label { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1.5px; color: var(--text-muted); position: relative; }
        .hero-val { font-size: 2.2rem; font-weight: 800; color: #fff; margin: 10px 0 5px 0; position: relative; text-shadow: 0 0 20px rgba(0,0,0,0.5); }
        .hero-sub { font-size: 0.95rem; color: var(--gold); font-weight: 600; position: relative; }

        /* --- STATS GRID --- */
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .stat-card {
            background: var(--card-glass); border: 1px solid var(--border-glass);
            padding: 15px; border-radius: 16px; display: flex; flex-direction: column;
        }
        .stat-card.active { border-color: rgba(0, 230, 118, 0.3); background: rgba(0, 230, 118, 0.05); }
        .stat-lbl { font-size: 0.7rem; color: #888; text-transform: uppercase; font-weight: 700; margin-bottom: 6px; }
        .stat-val { font-size: 1.1rem; font-weight: 700; color: #fff; }
        .stat-sub { font-size: 0.75rem; margin-top: 4px; }

        /* --- ACTION BUTTON --- */
        .btn-action {
            background: linear-gradient(135deg, #d4af37, #b8860b);
            color: #000; border: none; width: 100%; padding: 20px;
            border-radius: 16px; font-size: 1rem; font-weight: 800;
            text-transform: uppercase; letter-spacing: 1px;
            cursor: pointer; box-shadow: 0 8px 20px rgba(212,175,55,0.25);
            transition: transform 0.1s;
            display: flex; justify-content: space-between; align-items: center;
        }
        .btn-action:active { transform: scale(0.98); }
        .btn-action span:last-child { opacity: 0.6; font-size: 0.8rem; background: rgba(0,0,0,0.1); padding: 4px 8px; border-radius: 6px; }

        /* --- HISTORY LIST --- */
        .history-section { margin-top: 10px; }
        .history-header { font-size: 0.85rem; font-weight: 700; color: var(--text-muted); margin-bottom: 15px; border-bottom: 1px solid var(--border-glass); padding-bottom: 10px; display: flex; justify-content: space-between; }
        
        .log-item {
            background: rgba(255,255,255,0.03); border-radius: 12px; padding: 15px;
            margin-bottom: 10px; display: grid; grid-template-columns: 40px 1fr auto;
            align-items: center; border: 1px solid transparent;
            animation: slideIn 0.3s ease-out;
        }
        .log-item.new { border-color: var(--gold); background: rgba(212,175,55,0.05); }
        
        .log-day { 
            width: 30px; height: 30px; background: #222; color: var(--gold); 
            border-radius: 8px; display: flex; align-items: center; justify-content: center;
            font-weight: 700; font-size: 0.8rem;
        }
        .log-content { padding: 0 15px; }
        .log-title { font-weight: 600; font-size: 0.9rem; color: #eee; }
        .log-note { font-size: 0.75rem; color: #888; margin-top: 2px; }
        .log-amount { text-align: right; font-weight: 700; color: #fff; font-size: 0.95rem; }
        .log-signals { text-align: right; font-size: 0.7rem; color: var(--text-muted); margin-top: 2px; }

        .badge { padding: 3px 8px; border-radius: 4px; font-size: 0.65rem; font-weight: 800; display: inline-block; margin-right: 6px; vertical-align: middle; text-transform: uppercase; }
        .bg-gold { background: var(--gold); color: #000; }
        .bg-blue { background: #2979ff; color: #fff; }
        .bg-green { background: var(--green); color: #000; }
        .bg-red { background: rgba(255, 82, 82, 0.2); color: var(--red); border: 1px solid var(--red); }

        /* --- MODAL (SETTINGS & SETUP) --- */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.85); backdrop-filter: blur(5px);
            z-index: 2000; display: none; align-items: center; justify-content: center; padding: 20px;
        }
        .modal-box {
            background: #111; border: 1px solid var(--border-glass); width: 100%; max-width: 400px;
            border-radius: 20px; padding: 25px; box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            animation: scaleUp 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal-title { font-size: 1.2rem; font-weight: 800; color: #fff; margin-bottom: 20px; text-align: center; }
        
        .form-group { margin-bottom: 15px; }
        .form-label { display: block; font-size: 0.8rem; color: #888; margin-bottom: 8px; font-weight: 600; }
        .form-input { 
            width: 100%; background: #222; border: 1px solid #333; color: #fff;
            padding: 12px 15px; border-radius: 10px; font-size: 1rem; font-weight: 600;
            transition: border-color 0.3s;
        }
        .form-input:focus { border-color: var(--gold); }
        .btn-modal { width: 100%; padding: 15px; border-radius: 12px; border: none; font-weight: 700; font-size: 1rem; cursor: pointer; margin-top: 10px; }
        .btn-primary { background: var(--gold); color: #000; }
        .btn-secondary { background: #333; color: #fff; margin-top: 10px; }

        /* PROJECTION PANEL */
        #projPanel { display: none; margin-bottom: 20px; animation: slideIn 0.5s; }
        .proj-card { background: rgba(212,175,55,0.05); border: 1px solid var(--gold); padding: 20px; border-radius: 16px; margin-bottom: 15px; }

        @keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes scaleUp { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* AUDIO BUTTON PULSE */
        @keyframes pulseAudio { 0% { box-shadow: 0 0 0 0 rgba(212,175,55,0.4); } 70% { box-shadow: 0 0 0 10px rgba(0,0,0,0); } 100% { box-shadow: 0 0 0 0 rgba(0,0,0,0); } }
        .playing-audio { animation: pulseAudio 2s infinite; color: var(--gold) !important; border-color: var(--gold) !important; }

    </style>
</head>
<body>

    <audio id="audioPlayer" src="DVTMNP-PRO(2).mp3" preload="auto"></audio>

    <div id="splash">
        <img src="logo.png" alt="Logo" class="splash-logo" onerror="this.style.display='none'">
        <div class="splash-title">DVTEAM PRO</div>
        <div class="splash-sub">ROADMAP SIMULATOR</div>
    </div>

    <div id="setupModal" class="modal-overlay">
        <div class="modal-box">
            <div class="modal-title" id="modalTitle">PENGATURAN SIMULASI</div>
            
            <div class="form-group">
                <label class="form-label">Saldo Awal (USDT)</label>
                <input type="number" id="inpStartBal" class="form-input" value="100" placeholder="Contoh: 100">
            </div>

            <div class="form-group">
                <label class="form-label">Target Profit per Sinyal (%)</label>
                <input type="number" id="inpProfitPct" class="form-input" value="0.85" step="0.01" placeholder="Contoh: 0.85">
            </div>

            <div class="form-group">
                <label class="form-label">Rate IDR (Rupiah)</label>
                <input type="number" id="inpRateIDR" class="form-input" value="16000">
            </div>

            <button class="btn-modal btn-primary" onclick="saveSettingsAndStart()">SIMPAN & MULAI</button>
            <button class="btn-modal btn-secondary" onclick="closeModal()" id="btnCloseModal" style="display:none">BATAL</button>
        </div>
    </div>

    <div id="app">
        <header>
            <div class="brand">
                <img src="logo.png" alt="Icon" onerror="this.style.display='none'">
                <span>DVTEAM <span class="txt-gold">PRO</span></span>
            </div>
            <div style="display:flex; gap:10px">
                <button class="btn-icon" id="btnAudio" onclick="toggleAudio()">
                    <svg viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"/></svg>
                </button>
                <button class="btn-icon" onclick="openSettings()">
                    <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 0 0 .12-.61l-1.92-3.32a.488.488 0 0 0-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 0 0-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 0 0-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
                </button>
            </div>
        </header>

        <div class="scroll-content">
            
            <div class="hero-card">
                <div class="hero-label">Total Saldo Aset</div>
                <div class="hero-val" id="dispBal">0.00</div>
                <div class="hero-sub" id="dispBalIDR">Rp 0</div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-lbl">Keuntungan Bersih</div>
                    <div class="stat-val txt-green" id="dispProfIDR">Rp 0</div>
                    <div class="stat-sub txt-muted" id="dispProfUSDT">+0.00 USDT</div>
                </div>
                <div class="stat-card" id="cardTeam">
                    <div class="stat-lbl">Tim & Peringkat</div>
                    <div class="stat-val"><span id="dispTeam">0</span> <span style="font-size:0.8rem; font-weight:400">Org</span></div>
                    <div class="stat-sub txt-gold" id="dispRank">Member</div>
                </div>
            </div>

            <div id="controlPhase1">
                <div style="font-size:0.8rem; color:#666; margin-bottom:10px; text-align:center;" id="msgHint">
                    Siap memulai hari pertama.
                </div>
                <button class="btn-action" onclick="runDay()">
                    <span id="btnText">JALANKAN HARI 1</span>
                    <span id="dayInd">0 / 30</span>
                </button>
            </div>

            <div id="projPanel">
                <div class="proj-card">
                    <div style="color:var(--gold); font-weight:800; text-align:center; margin-bottom:15px; letter-spacing:1px;">VIP 2 TERCAPAI - MODE PROYEKSI</div>
                    <div style="display:flex; gap:10px; margin-bottom:15px;">
                        <input type="number" id="inpDays" value="30" class="form-input" style="text-align:center">
                        <div style="display:flex; align-items:center; font-size:0.9rem; color:#888;">Hari Kedepan</div>
                    </div>
                    <button class="btn-action" onclick="runProjection()">
                        <span>HITUNG HASIL AKHIR</span>
                        <span>&rarr;</span>
                    </button>
                    <div style="text-align:center; margin-top:15px">
                        <button onclick="undo()" id="btnUndo" style="background:transparent; border:none; color:#666; text-decoration:underline; cursor:pointer; display:none;">Undo / Kembali</button>
                    </div>
                </div>
                <div style="text-align:center;">
                    <button onclick="location.reload()" style="background:#222; border:1px solid #333; color:#fff; padding:10px 20px; border-radius:30px;">Reset Semua</button>
                </div>
            </div>

            <div class="history-section">
                <div class="history-header">
                    <span>RIWAYAT AKTIVITAS</span>
                    <span id="dispSig">2x Sinyal</span>
                </div>
                <div id="logList"></div>
            </div>

        </div>
    </div>

<script>
    // --- SERVICE WORKER ---
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('sw.js').catch(err => console.log('SW Fail'));
        });
    }

    // --- STATE MANAGEMENT ---
    let CONFIG = { 
        startBalance: 100, 
        profitRate: 0.85, // percent
        kurs: 16000,
        maxDaysPhase1: 30 
    };

    let state = { day: 0, balance: 100, signals: 2, team: 0, rank: "Member", phase: 1, history: [] };
    let isConfigured = false;

    // --- AUDIO ---
    const audio = document.getElementById('audioPlayer');
    const btnAudio = document.getElementById('btnAudio');
    function toggleAudio() {
        if (audio.paused) { audio.play(); btnAudio.classList.add('playing-audio'); } 
        else { audio.pause(); audio.currentTime = 0; btnAudio.classList.remove('playing-audio'); }
    }

    // --- EVENTS LOGIC (SAMA SEPERTI PERMINTAAN) ---
    const EVENTS = {
        5:  { txt: "Naik VIP 1", bonus: 70, tag: "VIP1", setSig: 3 },
        10: { txt: "Referral A (VIP 1)", bonus: 0, tag: "TIM", setSig: 3 },
        15: { txt: "Referral B (VIP 1)", bonus: 0, tag: "TIM", setSig: 3 },
        16: { txt: "Benefit Habis", bonus: 0, tag: "WARN", setSig: 2, note: "Turun ke 2 Sinyal (Cari Member!)" },
        20: { txt: "Referral C (VIP 1)", bonus: 0, tag: "TIM", setSig: 3, note: "Kembali 3 Sinyal" },
        25: { txt: "Referral D (VIP 1)", bonus: 0, tag: "TIM", setSig: 3 },
        30: { txt: "Referral E (VIP 1)", bonus: 100, tag: "VIP2", setSig: 3, note: "VIP 2 Permanen" }
    };

    // --- INITIALIZATION ---
    window.onload = function() {
        // Show Splash
        setTimeout(() => {
            document.getElementById('splash').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('splash').style.display = 'none';
                // Show Settings Modal first time
                document.getElementById('setupModal').style.display = 'flex';
            }, 500);
        }, 1500);
    };

    // --- SETTINGS FUNCTIONS ---
    function openSettings() {
        document.getElementById('inpStartBal').value = CONFIG.startBalance;
        document.getElementById('inpProfitPct').value = CONFIG.profitRate;
        document.getElementById('inpRateIDR').value = CONFIG.kurs;
        document.getElementById('modalTitle').innerText = "EDIT PENGATURAN";
        document.getElementById('btnCloseModal').style.display = 'inline-block';
        document.getElementById('setupModal').style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('setupModal').style.display = 'none';
    }

    function saveSettingsAndStart() {
        const bal = parseFloat(document.getElementById('inpStartBal').value) || 100;
        const prof = parseFloat(document.getElementById('inpProfitPct').value) || 0.85;
        const kurs = parseFloat(document.getElementById('inpRateIDR').value) || 16000;

        CONFIG.startBalance = bal;
        CONFIG.profitRate = prof;
        CONFIG.kurs = kurs;

        // Jika baru pertama kali (belum ada hari berjalan), reset saldo ke settingan baru
        if (state.day === 0) {
            state.balance = bal;
            updateUI();
        } else {
